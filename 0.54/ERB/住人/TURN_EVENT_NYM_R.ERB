
;-------------------------------------------------
;悩み再発
;-------------------------------------------------
@TURN_EVENT_NYM_R
#DIM L_NAYAMI_SLOT
L_NAYAMI_SLOT = RAND(1, 3)
SIF CFLAG:(4010 + L_NAYAMI_SLOT)
	RETURN
CALL MAKE_SMALL_NAYAMI(TARGET, L_NAYAMI_SLOT)
DRAWLINE
SETCOLOR 250,150,50
PRINTFORML 【悩み再発:%CALLNAME%】
PRINTFORML %CALLNAME%の様子がおかしい…
PRINTFORMW どうやら新たな悩みを抱えたようだ…
RESETCOLOR
CALL VAR_NAYAMI_SET_ASSIST(TARGET)



@MAKE_BIG_NAYAMI(L_C_ID, L_NAYAMI_SLOT)
#DIM L_C_ID
#DIM L_NAYAMI_SLOT
#DIM L_NAYAMI_TYPE
;大きな悩みの選択
SELECTCASE RAND(1, 7)
CASE 1
	;金銭問題
	L_NAYAMI_TYPE = RAND(100, 106)
CASE 2
	;恋愛問題
	L_NAYAMI_TYPE = RAND(200, 206)
CASE 3
	;家庭問題
	L_NAYAMI_TYPE = RAND(300, 306)
CASE 4
	;生活問題
	L_NAYAMI_TYPE = RAND(400, 405)
CASE 5
	;犯罪問題
	L_NAYAMI_TYPE = RAND(500, 504)
CASE 6
	;性的問題
	L_NAYAMI_TYPE = RAND(600, 606)
ENDSELECT
;決まった悩みの組み込み
CFLAG:L_C_ID:(4000 + L_NAYAMI_SLOT) = L_NAYAMI_TYPE
;難度の設定
CFLAG:L_C_ID:(4300 + L_NAYAMI_SLOT) = RAND(1, 11)
;最案の設定
;愚案の設定
CFLAG:L_C_ID:(4400 + L_NAYAMI_SLOT) = GET_BIG_NAYAMI_BEST_PLAN(L_NAYAMI_TYPE)
CFLAG:L_C_ID:(4300 + L_NAYAMI_SLOT) = RAND(1, 11)
CFLAG:L_C_ID:(4500 + L_NAYAMI_SLOT) = GET_BIG_NAYAMI_WORST_PLAN(L_NAYAMI_TYPE)
CFLAG:L_C_ID:(4200 + L_NAYAMI_SLOT) = 0
CFLAG:L_C_ID:(4100 + L_NAYAMI_SLOT) = 0



@MAKE_SMALL_NAYAMI(L_C_ID, L_NAYAMI_SLOT)
#DIM L_C_ID
#DIM L_NAYAMI_SLOT
#DIM L_NAYAMI_TYPE
;小さな悩みの選択
SELECTCASE RAND(1, 7)
CASE 1
	;金銭問題
	L_NAYAMI_TYPE = RAND(100, 105)
CASE 2
	;恋愛問題
	L_NAYAMI_TYPE = RAND(200, 205)
CASE 3
	;家庭問題
	L_NAYAMI_TYPE = RAND(300, 305)
CASE 4
	;生活問題
	L_NAYAMI_TYPE = RAND(400, 408)
CASE 5
	;犯罪問題
	L_NAYAMI_TYPE = RAND(500, 503)
CASE 6
	;性的問題
	L_NAYAMI_TYPE = RAND(600, 602)
ENDSELECT
;決まった悩みの組み込み
CFLAG:L_C_ID:(4010 + L_NAYAMI_SLOT) = L_NAYAMI_TYPE
;難度の設定
CFLAG:L_C_ID:(4310 + L_NAYAMI_SLOT) = RAND(1, 4)
;最案の設定
CFLAG:L_C_ID:(4410 + L_NAYAMI_SLOT) = GET_SMALL_NAYAMI_BEST_PLAN(L_NAYAMI_TYPE)
CFLAG:L_C_ID:(4210 + L_NAYAMI_SLOT) = 0
CFLAG:L_C_ID:(4110 + L_NAYAMI_SLOT) = 0



@GET_BIG_NAYAMI_BEST_PLAN(L_NAYAMI_TYPE)
#DIM L_NAYAMI_TYPE
#FUNCTION
SELECTCASE L_NAYAMI_TYPE
CASE 100, 403
	RETURNF 1
CASE 101, 102, 104, 302, 401, 600, 605
	RETURNF 2
CASE 103, 204, 205, 304, 305, 502, 604
	RETURNF 3
CASE 105, 202, 300, 400, 402, 602 
	RETURNF 4
;CASE 100, 403
;	RETURNF 5
CASE 201
	RETURNF 6
CASE 203, 404, 603
	RETURNF 7
CASE 200, 301, 303 
	RETURNF 8
CASE 500, 501
	RETURNF 9
ENDSELECT



@GET_BIG_NAYAMI_WORST_PLAN(L_NAYAMI_TYPE)
#FUNCTION
#DIM L_NAYAMI_TYPE
SELECTCASE L_NAYAMI_TYPE
CASE 201, 202, 203, 300, 301, 401, 402, 404, 600, 601
	RETURNF 1
CASE 204, 205, 603, 604
	RETURNF 2
CASE 100, 101, 102, 104
	RETURNF 3
CASE 103 
	RETURNF 4
CASE 105, 602
	RETURNF 5
CASE 200, 302, 303
	RETURNF 6
CASE 503, 605 
	RETURNF 7
;CASE 100, 403
;	RETURNF 8
;CASE 100, 403
;	RETURNF 9
ENDSELECT



@GET_SMALL_NAYAMI_BEST_PLAN(L_NAYAMI_TYPE)
#FUNCTION
#DIM L_NAYAMI_TYPE
SELECTCASE L_NAYAMI_TYPE
CASE 100, 101, 102, 103
	RETURNF 1
CASE 500, 501 
	RETURNF 2
CASE 400, 401, 407
	RETURNF 3
CASE 300, 301, 402, 404, 405, 600
	RETURNF 4
CASE 204, 304, 102, 103
	RETURNF 5
CASE 200, 201
	RETURNF 6
CASE 202, 203, 302
	RETURNF 7
CASE 403 
	RETURNF 8
CASE 502 
	RETURNF 9
ENDSELECT
