;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#
;
;	Module		:INFO_STATUS.ERB
;	Facility	:情報表示(STATUS)。
;				 情報を表示する関数を纏める。
;
;	Licence		:ライセンスフリー。
;
;	Modification Data:
;
;	Edit	Date			Author					Reason
;	001		20XX/XX/XX		----					新規作成
;	002		2014/09/28		なるはや				両親表示を追加
;	003		2017/02/28		morph					関数追加（INFO_STATUS_GROUP/INFO_STATUS_GET_BY_LABEL）
;	004		2018/11/13		いんどまん				@INFO_STATUS_GET_BY_LABELに随伴/後方/回収部隊で必要とされる能力値合計を表示するためのIF分岐追加
;	005		2018/11/14		morph					随伴/後方/回収部隊の能力値算出に使用する例外処理を@C_GET_CVAR_VALUEに移動、@INFO_STATUS_GET_BY_LABELの記述を差し戻し
;	006		2019/04/15		M						表示改修＆リファクタリングMOD: 表示桁幅指定、定型ラベル表示はPRINT_STATUS.ERBへ集約、0の値は伏字モードなど
;
;_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/#

;===============================================================================
;  ◇記載関数一覧(記載順)
;
;		Module Name						Explanation
;
; *- 表示系
;
;	・ INFO_STATUS_LIST					表示:STATUS画面(LIST)
;
;	# STATUS系(画面)
;	・ INFO_STATUS_MAIN					表示:STATUS画面
;	・ INFO_STATUS_GROUP				表示:配列利用情報表示関数
;	・ INFO_STATUS_BASES_PALAM			表示:STATUS画面(基本PALAM)
;	・ INFO_STATUS_BASES_LOG			表示:STATUS画面(基本履歴)
;	・ INFO_STATUS_TRAIN_DATA			表示:STATUS画面(調教履歴)
;
;	# STATUS系 - 詳細
;	・ INFO_STATUS_HEADER				表示:STATUS(ヘッダ)
;	・ INFO_STATUS_MARK					表示:STATUS(刻印)
;	・ INFO_STATUS_TALENT				表示:STATUS(素質)
;	・ INFO_STATUS_ABL					表示:STATUS(能力)
;	・ INFO_STATUS_EXP					表示:STATUS(経験)
;	・ INFO_STATUS_JUEL					表示:STATUS(珠)
;	・ INFO_STATUS_GOTJUEL				表示:STATUS(取得珠)
;	・ INFO_STATUS_INTRODUCTION			表示:STATUS(紹介)
;	・ INFO_STATUS_OTHER				表示:STATUS(その他)
;	・ INFO_INTRODUCTION				表示:STATUS(紹介)
;
;	# その他
;	・ INFO_SIMPLE_STATUS_EXP			簡易表示:STATUS(経験)
;	・ INFO_STATUS_GET_BY_LABEL			式中関数:ラベル使用キャラステータス参照関数


;===============================================================================

;-------------------------------------------------------------------------------
;   STATUS系(画面)
;-------------------------------------------------------------------------------

;=================================================
;   sub INFO_STATUS_LIST
;=================================================
;   表示:STATUS画面(LIST)
;-------------------------------------------------
@INFO_STATUS_LIST
#DIM L_INPUT
#DIMS L_ERR_MSG

;-----------------------------
;- 初期処理
;-----------------------------
L_INPUT=0
L_ERR_MSG=

;-----------------------------
;- データリスト
;-----------------------------
RESULT:1=0
$DATA_LIST

;- LIST:キャラリスト
CALL LIST_CHARA(@"ステータスを表示させたいキャラを選んでください　", RESULT:1, L_ERR_MSG)
L_INPUT = RESULT

;- 表示:ページ別
SELECTCASE L_INPUT
	;- 終了
	CASE 1000
		RETURN 0
	;- キャラ
	CASEELSE
		;表示:STATUS画面
		CALL INFO_STATUS_MAIN(L_INPUT)
		GOTO DATA_LIST
ENDSELECT
RESTART


;=================================================
;   sub INFO_STATUS_MAIN
;=================================================
;   表示:STATUS画面
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_MAIN(ARG)
#DIM L_TMP
#DIM L_PAGE_NOW
#DIM L_PAGE_下限
#DIM L_PAGE_上限
#DIM L_PAGE_前
#DIM L_PAGE_次

#DIM L_CHARA_前
#DIM L_CHARA_次

L_TMP=0
L_PAGE_下限=0
L_PAGE_上限=0

L_CHARA_前=0
L_CHARA_次=0

;-----------------------------
;- 定数設定
;-----------------------------
L_PAGE_下限 = 0
L_PAGE_上限 = 7


;-----------------------------
;- 処理開始
;-----------------------------
$PRINT_LOOP_1

L_CHARA_前 = VAR_GET_CL("PREV",ARG)
L_CHARA_次 = VAR_GET_CL("NEXT",ARG)

L_PAGE_前 = (L_PAGE_NOW > L_PAGE_下限) ? 1 # 0
L_PAGE_次 = (L_PAGE_NOW < L_PAGE_上限) ? 1 # 0

;- 表示:STATUS(ヘッダ)
		REDRAW 0
		CLEARLINE LINECOUNT
CALL INFO_STATUS_HEADER(ARG)
PRINTL

;- 表示:ページ別
SELECTCASE L_PAGE_NOW
	CASE 0
		;- 表示:STATUS画面(基本PALAM)
		DRAWLINE
		CALL INFO_STATUS_BASES_PALAM(ARG)
	CASE 1
		;- 表示:STATUS画面(詳細情報)
		DRAWLINE
		CALL INFO_PERSONAL(ARG)
	CASE 2
		;- 表示:STATUS画面(RPG情報)
		DRAWLINE
		CALL INFO_RPG(ARG)
	CASE 3
		;- 表示:STATUS画面(隠し性情報)
		DRAWLINE
		CALL INFO_SEX(ARG)
	CASE 4
		;- 表示:STATUS画面(調教履歴)
		DRAWLINE
		CALL INFO_STATUS_TRAIN_DATA(ARG)
	CASE 5
		;- 表示:STATUS画面(素質＆初体験)
		DRAWLINE
		CALL INFO_STATUS_OTHER(ARG)
	CASE 6
		;- 表示:STATUS画面(基本履歴)
		DRAWLINE
		CALL INFO_STATUS_BASES_LOG(ARG)
	CASE 7
		;- 表示:STATUS画面(紹介)
		DRAWLINE
		CALL INFO_INTRODUCTION(ARG)
ENDSELECT

;- 表示:選択部
PRINTFORMLC [1007]前のページ
PRINTLC [1000]戻る
PRINTFORMLC [1009]次のページ
IF L_PAGE_NOW == 2
	;PRINTFORMLC [3000] 衣装変更
ENDIF
PRINTL 
IF FLAG:遺研_研究中 ==  0
	PRINTFORMLC \@(L_CHARA_前 > -1) ? [1001]前のキャラ # %" " * 16%\@
	PRINTFORMLC   %" " * 18%
	PRINTFORMLC \@(L_CHARA_次 > -1) ? [1003]次のキャラ # %" " * 16%\@
ENDIF

$INPUT_LOOP_1
INPUT
SELECTCASE RESULT
	CASE 1000
		RETURN
	;衣装変更
	CASE 3000
		;- 衣装:変更画面
		CALL CLOTHES_CHG_MAIN(ARG)

	;前のページ
	CASE 1007
		IF L_PAGE_NOW == 0
			L_PAGE_NOW += 7
		ELSEIF L_PAGE_前
			L_PAGE_NOW -= 1
		ENDIF
	;次のページ
	CASE 1009
		IF L_PAGE_NOW ==7
			L_PAGE_NOW -= 7
		ELSEIF L_PAGE_次
			L_PAGE_NOW += 1
		ENDIF
	;前のキャラ
	CASE 1001
		SIF L_CHARA_前 > -1
			ARG = L_CHARA_前
	;次のキャラ
	CASE 1003
		SIF L_CHARA_次 > -1
			ARG = L_CHARA_次
	CASEELSE
		;- INPUTエラー対応
		CALL C_INPUT_ERROR
		GOTO INPUT_LOOP_1
ENDSELECT

GOTO PRINT_LOOP_1



;-------------------------------------------------
;配列利用情報表示関数
;-------------------------------------------------
;@INFO_STATUS_MAINからパクった
;配列を渡さないと機能しないので注意
;ページやキャラリストの端と端がつながってます
;渡された配列に含まれる登録番号のキャラの情報を閲覧することが出来る
;戻り値：OPに「最終確認」が含まれる場合、1で決定を行うとRESULTに表示キャラの登録番号が記録される
;
;OPに含まれる文字列によって機能を切り替える
;「最終確認」　　このオプションを指定して
;　　　　　　　　1で決定を行うとRESULTに表示キャラの登録番号が記録される
;「キャラ固定」　このオプションを指定するとキャラの切替ができない
@INFO_STATUS_GROUP(CHARA_LIST, CHARA_VIEW, CHARA_CNT, OP)
#DIM REF   CHARA_LIST      ;表示に使用するキャラリスト、必須
#DIM       CHARA_VIEW      ;現在閲覧中のキャラのリスト上の位置
#DIM       CHARA_CNT       ;キャラリストのサイズ
#DIMS      OP              ;実行オプション
#DIM       L_PAGE_NOW  = 0 ;閲覧中のページ数
#DIM CONST PAGE_SIZE   = 8 ;ページのサイズ
{
#DIMS CONST TYPE_STATUS, 8 = 
	"基本PALAM", 
	"詳細情報", 
	"RPG情報", 
	"生殖情報", 
	"調教履歴", 
	"特殊素質＆初体験", 
	"基本履歴", 
	"人物紹介"
}

;- 表示:STATUS(ヘッダ)
REDRAW 0
CLEARLINE LINECOUNT
CALL INFO_STATUS_HEADER(CHARA_LIST:CHARA_VIEW)

SELECTCASE TYPE_STATUS:L_PAGE_NOW
CASE "基本PALAM", 
	;- 表示:STATUS画面(基本PALAM)
	DRAWLINE
	CALL INFO_STATUS_BASES_PALAM(CHARA_LIST:CHARA_VIEW)
CASE "詳細情報", 
	;- 表示:STATUS画面(詳細情報)
	DRAWLINE
	CALL INFO_PERSONAL(CHARA_LIST:CHARA_VIEW)
CASE "RPG情報", 
	;- 表示:STATUS画面(RPG情報)
	DRAWLINE
	CALL INFO_RPG(CHARA_LIST:CHARA_VIEW)
CASE "生殖情報", 
	;- 表示:STATUS画面(隠し性情報)
	DRAWLINE
	CALL INFO_SEX(CHARA_LIST:CHARA_VIEW)
CASE "調教履歴", 
	;- 表示:STATUS画面(調教履歴)
	DRAWLINE
	CALL INFO_STATUS_TRAIN_DATA(CHARA_LIST:CHARA_VIEW)
CASE "特殊素質＆初体験", 
	;- 表示:STATUS画面(初体験)
	DRAWLINE
	CALL INFO_STATUS_OTHER(CHARA_LIST:CHARA_VIEW)
CASE "基本履歴", 
	;- 表示:STATUS画面(基本履歴)
	DRAWLINE
	CALL INFO_STATUS_BASES_LOG(CHARA_LIST:CHARA_VIEW)
CASE "人物紹介"
	;- 表示:STATUS画面(紹介)
	DRAWLINE
	CALL INFO_INTRODUCTION(CHARA_LIST:CHARA_VIEW)
ENDSELECT

IF STRCOUNT(OP, "「最終確認」") || STRCOUNT(OP, "「キャラ固定」")
	PRINTFORM %"　" * 8%
ELSE
	PRINTBUTTON "[7] - 　施設配属", 7
ENDIF
PRINTFORM %"　" * 1%
IF STRCOUNT(OP, "「キャラ固定」")
ELSE
	PRINTBUTTON "[8] - 前のキャラ", 8
ENDIF
PRINTFORM %"　" * 1%
IF STRCOUNT(OP, "「最終確認」") || STRCOUNT(OP, "「キャラ固定」")
	PRINTFORM %"　" * 8%
ELSE
	PRINTBUTTON "[9] - 　部隊配属", 9
ENDIF
PRINTFORML 

PRINTBUTTON @"[4] - 　%TYPE_STATUS:((L_PAGE_NOW + PAGE_SIZE - 1) % PAGE_SIZE), 14*2,LEFT%", 4
PRINTBUTTON @"[6] - 　%TYPE_STATUS:((L_PAGE_NOW + PAGE_SIZE + 1) % PAGE_SIZE), 14, LEFT%", 6
PRINTFORML 
PRINTFORM %"　" * 8%
PRINTFORM %"　" * 1%
IF STRCOUNT(OP, "「キャラ固定」")
ELSE
	PRINTBUTTON "[2] - 次のキャラ", 2
ENDIF
PRINTFORM %"　" * 1%
PRINTFORML 

IF STRCOUNT(OP, "「最終確認」")
	PRINTBUTTON "[1] - 　　　決定", 1
	PRINTFORM 　　　　　　　　　　
	PRINTBUTTON "[0] - キャンセル", 0
	PRINTFORML 
ELSE
	PRINTBUTTON "[0] - もどる", 0
ENDIF

DO
	ONEINPUT
	SELECTCASE RESULT
	CASE 1
		SIF !STRCOUNT(OP, "「最終確認」")
			GOTO RETRY
		RETURN CHARA_LIST:CHARA_VIEW
	CASE 0
		RETURN -1
	[SKIPSTART]
	;衣装変更
	CASE 3000
		;- 衣装:変更画面
		CALL CLOTHES_CHG_MAIN(ARG)
	[SKIPEND]
	;前のページ
	CASE 4
		L_PAGE_NOW = (L_PAGE_NOW + PAGE_SIZE - 1) % PAGE_SIZE
	;次のページ
	CASE 6
		L_PAGE_NOW = (L_PAGE_NOW + PAGE_SIZE + 1) % PAGE_SIZE
	;施設配属
	CASE 7
		SIF STRCOUNT(OP, "「最終確認」") || STRCOUNT(OP, "「キャラ固定」")
			GOTO RETRY
		CALL SELECT_WOKER(CHARA_LIST:CHARA_VIEW)
	;前のキャラ
	CASE 8
		SIF STRCOUNT(OP, "「キャラ固定」")
			GOTO RETRY
		CHARA_VIEW = (CHARA_VIEW + CHARA_CNT - 1) % CHARA_CNT
	;部隊配属
	CASE 9
		SIF STRCOUNT(OP, "「最終確認」") || STRCOUNT(OP, "「キャラ固定」")
			GOTO RETRY
		CALL SELECT_SUPPORT(CHARA_LIST:CHARA_VIEW)
	;次のキャラ
	CASE 2
		SIF STRCOUNT(OP, "「キャラ固定」")
			GOTO RETRY
		CHARA_VIEW = (CHARA_VIEW + CHARA_CNT + 1) % CHARA_CNT
	CASEELSE
		$RETRY
		;- INPUTエラー対応
		CALL C_INPUT_ERROR("無効な入力です")
		CONTINUE
	ENDSELECT
	BREAK
LOOP 1
RESTART



;@INFO_STATUS_GROUPの呼び出し用関数
;キャラ番号を渡すことで単体の能力表示関数として動作する
@INFO_STATUS_SINGLE(L_C_ID, OP)
#DIM  L_C_ID
#DIMS OP
CALL INFO_STATUS_GROUP(L_C_ID, 0, 1, OP + "「キャラ固定」")



;=================================================
;   sub INFO_STATUS_BASES_PALAM
;=================================================
;   表示:STATUS画面(基本PALAM)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_BASES_PALAM(ARG)

;-- 刻印

;- ライン表示:見出し
CALL C_HEADLINE("刻印(MARK)")
;- 表示:STATUS(刻印)
CALL INFO_STATUS_MARK(ARG)
PRINTL


;-- 素質

;- ライン表示:見出し
CALL C_HEADLINE("素質(TALENT)")
;- 表示:STATUS(素質)
CALL INFO_STATUS_TALENT(ARG)
PRINTL


;-- 能力
;- ライン表示:見出し
CALL C_HEADLINE("能力(ABL)")
;- 表示:STATUS(能力)
CALL INFO_STATUS_ABL(ARG)
PRINTL


;=================================================
;   sub INFO_STATUS_BASES_LOG
;=================================================
;   表示:STATUS画面(基本履歴)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_BASES_LOG(ARG)

;-- 経験

;- ライン表示:見出し
CALL C_HEADLINE("経験(EXP)")
;- 表示:STATUS(経験)
CALL INFO_STATUS_EXP(ARG)
PRINTL


;-- 珠

;- ライン表示:見出し
CALL C_HEADLINE("珠(JUEL)")
;- 表示:STATUS(珠)
CALL INFO_STATUS_JUEL(ARG)
PRINTL

;=================================================
;   sub INFO_STATUS_TRAIN_DATA
;=================================================
;   表示:STATUS画面(調教履歴)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_TRAIN_DATA(ARG)
#DIM L_I

L_I = ARG
SETCOLOR 250,100,200
PRINTFORML ――――――――――――――――――――――――%CALLNAME:L_I%の調教履歴――――――――――――――――――――――――


IF  MASTER != L_I
	IF TALENT:L_I:寵愛 == 1
		CALL PRINT_LABEL("寵愛　　　　　　")
		IF CFLAG:L_I:体型 == 2
			PRINTFORML 		%CALLNAME:MASTER%はその色気ある豊満な身体に惚れ込み、寵愛を注いでいる。
		ELSEIF CFLAG:L_I:体型 == 0
			PRINTFORML 		%CALLNAME:MASTER%はその美しい華奢な身体に惚れ込み、寵愛を注いでいる。
		ELSE
			PRINTFORML 		%CALLNAME:MASTER%はその容姿に惚れ込み、寵愛を注いでいる。
		ENDIF
	ELSEIF Exp:L_I:主人調教経験 >= 500
		CALL PRINT_LABEL("お気に入り　　　")
		IF CFLAG:L_I:体型 == 2
			PRINTFORML 		%CALLNAME:MASTER%にその色気ある豊満な身体を狙われ、幾度も抱かれている。
		ELSEIF CFLAG:L_I:体型 == 0
			PRINTFORML 		%CALLNAME:MASTER%にその美しい華奢な身体を狙われ、幾度も抱かれている。
		ELSE
			PRINTFORML 		%CALLNAME:MASTER%にその容姿を見染められ、幾度も抱かれている。
		ENDIF
	ENDIF
	IF TALENT:L_I:心酔 == 1
		CALL PRINT_LABEL("心酔　　　　　　")
		PRINTFORML 		%CALLNAME:L_I%は%CALLNAME:MASTER%に心から崇拝している。
	ELSEIF TALENT:L_I:愛人 == 1
		CALL PRINT_LABEL("愛人　　　　　　")
		PRINTFORML 		%CALLNAME:L_I%は%CALLNAME:MASTER%に深い愛情を抱いている。
	ELSEIF TALENT:L_I:情婦 == 1
		CALL PRINT_LABEL("情婦　　　　　　")
		PRINTFORML 		%CALLNAME:L_I%は%CALLNAME:MASTER%との肉体関係に酔いしれている。
	ENDIF

	IF TALENT:L_I:合意 == 1
		CALL PRINT_LABEL("合意　　　　　　")
		PRINTFORML 		%CALLNAME:MASTER%と性行為することに合意している。
	ENDIF
	IF TALENT:L_I:調教済み == 1
		CALL PRINT_LABEL("調教済み　　　　")
		PRINTFORML 		性的な調教を施されており、身体が常に快楽を求めている。
	ENDIF
	IF Exp:L_I:パイズリ経験 >= 900
		CALL PRINT_LABEL("パイズリLvMAX 　")
		PRINTFORML 		胸で射精させるなど容易いほどの技巧を持つ。
	ELSEIF Exp:L_I:パイズリ経験 >= 700
		CALL PRINT_LABEL("パイズリLv4　 　")
		PRINTFORML 		性行為と同等の快楽を与えることが可能になった。
	ELSEIF Exp:L_I:パイズリ経験 >= 500
		CALL PRINT_LABEL("パイズリLv3　 　")
		PRINTFORML 		どのようなペニスだろうと射精させることが出来る。
	ELSEIF Exp:L_I:パイズリ経験 >= 300
		CALL PRINT_LABEL("パイズリLv2　 　")
		PRINTFORML 		巧みに胸を使い射精へ導くことが出来る。
	ELSEIF Exp:L_I:パイズリ経験 >= 100
		CALL PRINT_LABEL("パイズリLv1　 　")
		PRINTFORML 		胸で射精させることが出来るようになった。
	ENDIF

	IF Exp:L_I:フェラ経験 >= 900
		CALL PRINT_LABEL("フェラLvMAX　 　")
		PRINTFORML 		彼女のフェラで射精を我慢することはできない。。
	ELSEIF Exp:L_I:フェラ経験 >= 700
		CALL PRINT_LABEL("フェラLv4　　 　")
		PRINTFORML 		もはや性器のような快楽を持つ口だ。
	ELSEIF Exp:L_I:フェラ経験 >= 500
		CALL PRINT_LABEL("フェラLv3　　 　")
		PRINTFORML 		射精を促進する仕草やテクニックも出来る。
	ELSEIF Exp:L_I:フェラ経験 >= 300
		CALL PRINT_LABEL("フェラLv2　　 　")
		PRINTFORML 		余裕も出てきて舌も使えるようになった。
	ELSEIF Exp:L_I:フェラ経験 >= 100
		CALL PRINT_LABEL("フェラLv1　　 　")
		PRINTFORML 		射精され精液を口に含むのにも慣れてきた。
	ENDIF

	IF Exp:L_I:性交経験 >= 900
		CALL PRINT_LABEL("セックスLvMAX 　")
		PRINTFORML 		淫靡な腰つきで射精を促し、精液を全て吐き出すまで離さないほど交尾が大好き。
	ELSEIF Exp:L_I:性交経験 >= 700
		CALL PRINT_LABEL("セックスLv4　 　")
		PRINTFORML 		性別の違いを好意的に捉えるほど、セックスに夢中。
	ELSEIF Exp:L_I:性交経験 >= 500
		CALL PRINT_LABEL("セックスLv3　 　")
		PRINTFORML 		膣内にペニスがないと落ち着かず、膣内は常にトロトロになっている。
	ELSEIF Exp:L_I:性交経験 >= 300
		CALL PRINT_LABEL("セックスLv2　 　")
		PRINTFORML 		交尾に完全順応しペニスの機能を把握、膣内でその状況を察知できる。
	ELSEIF Exp:L_I:性交経験 >= 100
		CALL PRINT_LABEL("セックスLv1　 　")
		PRINTFORML 		雄との交尾にも慣れ、膣内にペニスが入り込む異物感に適応した。
	ENDIF

	IF TALENT:L_I:ヤンデレ == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("愛を食む狂気　　")
		PRINTFORML 		%CALLNAME:MASTER%に愛される為ならば、どんなことだって…
	ENDIF
	IF TALENT:L_I:ツンデレ == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("デレ期　　　　　")
		PRINTFORML 		ツンツンしてたあの頃は何処へやら、視線を向ければはにかむ姿が見える。
	ENDIF
	IF TALENT:L_I:マドンナ == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("恋するﾏﾄﾞﾝﾅ　 　")
		PRINTFORML 		愛と性を知りより魅力的になった、そしてもう届かぬと思いつつも虜になる男も急増中。
	ENDIF
	IF TALENT:L_I:高嶺の花 == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("恋慕の花　　　　")
		PRINTFORML 		恋するその姿に皆が噂している…、誰が彼女の心を射止めたのかを。
	ENDIF
	IF TALENT:L_I:人間不信 == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("解かれた心　　　")
		PRINTFORML 		他者を拒絶する鎖錠を破り、孤独だった彼女はようやく人を愛した。
	ENDIF
	IF TALENT:L_I:極上の牝 == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("至高の愛人　　　")
		PRINTFORML 		男であれば誰もが犯したいその肢体は、%CALLNAME:MASTER%の色で染め上げられた。
	ENDIF
	IF TALENT:L_I:聖女の血族 == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("聖痕を刻む聖女　")
		PRINTFORML 		聖なる聖女は一人の遺伝子のみを育むことを誓った。
	ELSEIF TALENT:L_I:聖女の子宮 == 1 && Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("聖痕を刻む子宮　")
		PRINTFORML 		聖なる子宮は一人の遺伝子のみを育むことを誓った。
	ENDIF
	IF TALENT:L_I:アイドル == 1 &&  Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("ｱｲﾄﾞﾙのﾋﾐﾂ　　　")
		PRINTFORML 		ファン達は知らない…その笑顔は一人にしか向けられていないことを。
	ENDIF
	IF TALENT:L_I:メイド == 1 &&  Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("主従を超えて　　")
		PRINTFORML  	%CALLNAME:MASTER%に最も近き女として、誰よりも愛されたい…
	ENDIF
	IF TALENT:L_I:学生  &&  Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("ｸﾗｽ1番のｵﾄﾅ　 　")
		PRINTFORML 		クラス男子たちが一番ドキドキする相手、一足先にオトナになった若々しい雌。
	ENDIF
	IF TALENT:L_I:男嫌い == 1 &&  Exp:L_I:主人調教経験 >= 100 && ( TALENT:L_I:心酔 == 1 || TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("…男は嫌い　　　")
		PRINTFORML 		…でもあの男には身体を許してしまう、どうしても関係を切れない……。
	ENDIF
	IF TALENT:L_I:白百合姫 == 1 && (TALENT:L_I:心酔 == 1|| TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("白濁の百合姫　　")
		PRINTFORML 		白百合だろうと受粉の定めには逃れられない、今や胤を求める一輪の雌花。
	ELSEIF TALENT:L_I:同性愛 == 1 && Exp:L_I:主人調教経験 >= 100 && (TALENT:L_I:心酔 == 1|| TALENT:L_I:愛人 == 1 || TALENT:L_I:情婦 == 1)
		CALL PRINT_LABEL("レズ堕とし　　　")
		PRINTFORML 		雄という存在に屈服し異性間の性行為、子を孕み産むという雌の在り方を認めた。
	ENDIF
	IF TALENT:L_I:ＮＴＲ度 == 1
		CALL PRINT_LABEL("ＮＴＲ　　　　　")
		PRINTFORML 		%CALLNAME:L_I%は%CALLNAME:MASTER%ではなく、誰かに寝取られてしまった…。
	ENDIF
	IF TALENT:L_I:ＮＴＬ == 1
		CALL PRINT_LABEL("ＮＴＬ　　　　　")
		PRINTFORML 		愛する人がいるはずの%CALLNAME:L_I%の身と心は、もはや%CALLNAME:MASTER%のものだ。
	ENDIF
	IF TALENT:L_I:百合摘み == 1
		CALL PRINT_LABEL("百合摘み　　　　")
		PRINTFORML 		愛する女性がいるはずの%CALLNAME:L_I%の身と心は、もはや%CALLNAME:MASTER%のものだ。
	ENDIF
	IF CFLAG:L_I:あなたの子の出産数
		CALL PRINT_LABEL("孕ませ済み　　　")
		PRINTFORML 		%CALLNAME:MASTER%の精子で受精し受胎、そして%CALLNAME:MASTER%の血を継承した子を出産した。
	ENDIF
	IF TALENT:L_I:托卵済み == 1
		CALL PRINT_LABEL("托卵済み　　　　")
		PRINTFORML 		夫と育てている子は夫の血ではなく、%CALLNAME:MASTER%の血を引いた愛し子だ。
	ELSEIF TALENT:L_I:托卵 == 1
		CALL PRINT_LABEL("托卵　　　　　　")
		PRINTFORML 		契りを結んだ相手ではなく、%CALLNAME:MASTER%との子を孕んでいる。
	ENDIF
	IF TALENT:L_I:被托卵済み == 1
		CALL PRINT_LABEL("被托卵済み　　　")
		PRINTFORML 		愛しているはずの%CALLNAME:MASTER%ではない子を自ら望んで産んだ…
	ELSEIF TALENT:L_I:被托卵 == 1
		CALL PRINT_LABEL("被托卵　　　　　")
		PRINTFORML 		愛しているはずの%CALLNAME:MASTER%ではない種で孕んでいる…
	ENDIF
	IF TALENT:L_I:浮気 == 3
		CALL PRINT_LABEL("浮気　　　　　　")
		PRINTFORML 		夫だけでなく「夫の上司」と密かに肉体関係を持っている。
	ELSEIF TALENT:L_I:浮気 == 2
		CALL PRINT_LABEL("浮気　　　　　　")
		PRINTFORML 		夫だけでなく「幼馴染」と密かに肉体関係を持っている。
	ELSEIF TALENT:L_I:浮気 == 1
		CALL PRINT_LABEL("浮気　　　　　　")
		PRINTFORML 		夫だけでなく「元カレ」と密かに肉体関係を持っている。
	ENDIF
	IF CFLAG:交配実験_子宮内汚染度 >= 97
		CALL PRINT_LABEL("まつろわぬ聖域　")
		PRINTFORML 		実験によって汚染され切った子宮は人を産む聖域ではなくなった…。
	ENDIF
	IF CFLAG:交配実験_出産回数 >= 45
		CALL PRINT_LABEL("人ならざる愛し子")
		PRINTFORML 		交配実験の末、%CALLNAME:L_I%は人ではない子を数多く産み落とした…。
	ENDIF




	IF CFLAG:L_I:子宮精液貯蔵量合計 > 0
		CALL PRINT_LABEL(@"%CALLNAME:MASTER%との子作り")
		IF CFLAG:L_I:子宮精液貯蔵量 > 0
			;<!>謎の一行のせいで、残留がなくても表示されるようになってた...
		PRINTFORM 	
		PRINTFORM %CALLNAME:MASTER%の種付けで{CFLAG:L_I:子宮精液貯蔵量/500}mlの精液が子宮に残留中であり、
		ENDIF
		PRINTFORML 	現在まで{CFLAG:L_I:子宮精液貯蔵量合計/500}mlの精液を子宮に蓄えた。
	ENDIF
ENDIF

PRINTFORML ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――
RESETCOLOR
;-------------------------------------------------------------------------------
;   STATUS系(詳細)
;-------------------------------------------------------------------------------

;=================================================
;   sub INFO_STATUS_HEADER
;=================================================
;   表示:STATUS(ヘッダ)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_HEADER(ARG)
;表示:ページヘッダ
CALL C_LINE
PRINTFORM NO.%TOSTR(CFLAG:ARG:個別番号) , 3, LEFT%:
PRINTFORM %CALLNAME:ARG,24,LEFT%
;体力
CALL VAR_BAR_BASE(ARG, 0, 1)
SIF ARG != MASTER
	CALL MNG_INFO_BASIC_DATA(ARG)
;- 情報:危険日
CALL INFO_危険日(ARG)
PRINTL

;=================================================
;   sub INFO_STATUS_MARK
;=================================================
;   表示:STATUS(刻印)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_MARK(ARG)
#DIM L_CNT

L_CNT=0

VARSET LOCAL
FOR LOCAL,0,VARSIZE("MARK")

	LOCALS = %MARKNAME:LOCAL%
	SIF STRLENS(LOCALS) <= 0
		CONTINUE
	LOCAL:1 = MARK:ARG:LOCAL

	SIF LOCAL:1 <= 0 && FLAG:STATUS伏字モード
		SETCOLOR COLOR("伏字")
	PRINTFORM %LOCALS , 10%
	PRINTFORM :LV{LOCAL:1, 2 ,LEFT} 
	BAR LOCAL:1, 3, 3
	PRINT  
	RESETCOLOR

	L_CNT += 1
	IF L_CNT > 3
		PRINTL
		L_CNT = 0
	ENDIF
NEXT

SIF !LINEISEMPTY()
	PRINTL


;=================================================
;   sub INFO_STATUS_TALENT
;=================================================
;   表示:STATUS(素質)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;  ARG:1				CSV優先
;-------------------------------------------------
@INFO_STATUS_TALENT(ARG, ARG:1=0)
#DIM L_CNT
#DIM L_COLOR
#DIM L_I
#DIMS L_STR
#DIM DYNAMIC L_LABELCOLOR
#DIM CONST L_LAYOUT_OFFSET = 14

L_CNT=0
L_COLOR = GETCOLOR()


FOR L_I,0,VARSIZE("TALENT")
	L_LABELCOLOR = -1

	SELECTCASE L_I
		CASE 0
			CALL PRINT_LABEL("ABL素質")
			PRINTFORM %"：",L_LAYOUT_OFFSET-RESULT%
		CASE 50
			PRINTL
			CALL PRINT_LABEL("体質素質")
			PRINTFORM %"：",L_LAYOUT_OFFSET-RESULT%
			L_CNT = 0
		CASE 100
			PRINTL
			CALL PRINT_LABEL("個人素質")
			PRINTFORM %"：",L_LAYOUT_OFFSET-RESULT%
			L_CNT = 0
		CASE 200
			PRINTL
			CALL PRINT_LABEL("対人素質")
			PRINTFORM %"：",L_LAYOUT_OFFSET-RESULT%
			L_CNT = 0
		CASE 3000
			PRINTL
			CALL PRINT_LABEL("機密素質")
			PRINTFORM %"：",L_LAYOUT_OFFSET-RESULT%
			L_CNT = 0
	ENDSELECT

	;- DB:TALENT名称
	L_STR = %DB_TALENT_NAME(ARG, TALENTNAME:L_I, ARG:1)%

	;-特殊変換
	SELECTCASE TALENTNAME:L_I
		CASE "始祖"
			IF CFLAG:(ARG):次世代創造子孫数
				L_STR = 始祖:創造数{MIN(CFLAG:(ARG):次世代創造子孫数, 999), 3, RIGHT}
			ELSE
				L_STR = 
			ENDIF
		CASE "髪色","髪型","目","瞳色","唇","体型","乳首","陰毛","ペニスサイズ","母親"
		L_STR = 
	ENDSELECT


	;-特殊変換
	SELECTCASE TALENTNAME:L_I
		CASE "オトコ"
			IF VAR_SEX(ARG, ARG:1)
				L_STR = オンナ
			ELSE
				L_STR = オトコ
			ENDIF
	ENDSELECT

	SIF STRLENS(L_STR) <= 0
		CONTINUE

	IF L_CNT > 95;75
		PRINTL
		PRINTFORM %" ",L_LAYOUT_OFFSET%
		L_CNT = 0
	ENDIF

	L_CNT += STRLENS(L_STR)

	;-着色
	SELECTCASE L_STR
		CASE "処女", "男の娘"
			L_LABELCOLOR = 0xFF66CC
		CASE "童貞"
			L_LABELCOLOR = COLOR("群青")
		CASE "非戦闘員","非人型","抵抗","傷物","人間不信"
			L_LABELCOLOR = COLOR("群青")
		CASE "排卵薬", "妊娠", "受精" ,"心酔" ,"愛人" ,"情婦" ,"惚れっぽい" ,"即堕ち"
			L_LABELCOLOR = COLOR("ピンク")
		CASE "ＮＴＲ", "悪魔", "半魔", "造魔", "弱み", "ＮＴＬ","托卵","托卵済み","被托卵","被托卵済み","浮気"
			L_LABELCOLOR = COLOR("紫")
		CASE "非合意", "犯され","不在","記憶処理済","レイプ願望","イレギュラー","ボランティア","強化住人"
			L_LABELCOLOR = COLOR_FROMRGB(250,0,0)
		CASE "青き血族"
			L_LABELCOLOR = COLOR_FROMRGB(50,50,250)
		CASE "合意"
			L_LABELCOLOR = COLOR_FROMRGB(250,250,100)
		CASE "聖女の子宮", "極上の牝" ,"マドンナ","万年乳期","聖女の血族"
			L_LABELCOLOR = COLOR_FROMRGB(250,250,200)
		CASE "学生", "大学生", "高校生", "中学生", "小学生"
			IF (TALENT:(ARG:0):アイドル || TALENT:(ARG:0):娼婦)
				L_LABELCOLOR = COLOR_FROMRGB(250,100,50)
			ELSE
				L_LABELCOLOR = COLOR_FROMRGB(50,250,50)
			ENDIF
		CASE "アイドル", "社会人", "娼婦", "治安維持局員", "メイド", "聖職者","AI専属被験者"
			L_LABELCOLOR = COLOR_FROMRGB(50,250,50)
		CASE "機密Lv1個体", "機密Lv2個体", "機密Lv3個体"
			L_LABELCOLOR = COLOR_FROMRGB(50,250,50)
		CASE "機密Lv4個体", "機密Lv5個体", "機密Lv6個体"
			L_LABELCOLOR = COLOR_FROMRGB(250,250,50)
		CASE "機密Lv7個体", "機密Lv8個体", "機密Lv9個体"
			L_LABELCOLOR = COLOR_FROMRGB(250,50,50)
	ENDSELECT

	CALL PRINT_LABEL(L_STR,,L_LABELCOLOR,,,,,,,,1)

	;- 外枠分を加算
	L_CNT += 2

NEXT

SIF !LINEISEMPTY()
	PRINTL


;=================================================
;   sub INFO_STATUS_ABL
;=================================================
;   表示:STATUS(能力)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;  ARG:1				空データ除外
;-------------------------------------------------
@INFO_STATUS_ABL(ARG, ARG:1=0)
#DIM L_CNT
#DIM L_COLOR

L_CNT=0
L_COLOR = GETCOLOR()

VARSET LOCAL
FOR LOCAL,0,VARSIZE("ABL")

	LOCALS = %ABLNAME:LOCAL%
	SIF STRLENS(LOCALS) <= 0
		CONTINUE
	LOCAL:1 = ABL:ARG:LOCAL

	SIF ARG:1 && !LOCAL:1
		CONTINUE

	SIF LOCAL:1 <= 0 && FLAG:STATUS伏字モード
		SETCOLOR COLOR("伏字")
	PRINTFORM %LOCALS , 10%
	PRINTFORM :LV{LOCAL:1, 2, LEFT} 
	BAR (LOCAL:1/3), 3, 3
	SIF LOCAL:1 <= 0 && FLAG:STATUS伏字モード
		SETCOLOR L_COLOR
	PRINT  

	L_CNT += 1
	IF L_CNT > 3
		PRINTL
		L_CNT = 0
	ENDIF
NEXT

SIF !LINEISEMPTY()
	PRINTL

;=================================================
;   sub INFO_STATUS_EXP
;=================================================
;   表示:STATUS(経験)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;  ARG:1				空データ除外
;-------------------------------------------------
@INFO_STATUS_EXP(ARG, ARG:1=0)
#DIM L_CNT
#DIM L_COLOR
#DIM CONST EXP_STATUS_SPAN = 29

L_CNT=0
L_COLOR = GETCOLOR()
VARSET LOCAL

FOR LOCAL,0,VARSIZE("EXP")

	;ヘッダー
	SELECTCASE LOCAL
		CASE 0
			PRINTFORM %"■======= 通常経験 =======■", EXP_STATUS_SPAN , LEFT% 
			L_CNT = 1
		CASE 50
			SIF !LINEISEMPTY()
				PRINTL
			PRINTFORM %"■=== アブノーマル経験 ===■", EXP_STATUS_SPAN , LEFT% 
			L_CNT = 1
		CASE 80
			SIF !LINEISEMPTY()
				PRINTL
			PRINTFORM %"■====== その他経験 ======■", EXP_STATUS_SPAN , LEFT% 
			L_CNT = 1
	ENDSELECT

	LOCALS = %EXPNAME:LOCAL%
	SIF STRLENS(LOCALS) <= 0
		CONTINUE
	LOCAL:1 = EXP:ARG:LOCAL

	SIF ARG:1 && !LOCAL:1
		CONTINUE

	;CHK:数量(必須表示のみ素通り)
	SELECTCASE LOCAL
		CASE 0,50,60
		CASEELSE
;			SIF LOCAL:1 <= 0
;				CONTINUE
	ENDSELECT

	SIF LOCAL:1 <= 0 && FLAG:STATUS伏字モード
		SETCOLOR COLOR("伏字")
	PRINTFORM %@"%LOCALS , 16%:LV{GETEXPLV(LOCAL:1,9), 2, LEFT}(%TOSTR(LOCAL:1) , 4%回)", EXP_STATUS_SPAN , LEFT%
	SIF LOCAL:1 <= 0 && FLAG:STATUS伏字モード
		SETCOLOR L_COLOR
	PRINT  

	L_CNT += 1
	IF L_CNT > 2
		PRINTL
		L_CNT = 0
	ENDIF

NEXT

SIF !LINEISEMPTY()
	PRINTL

;=================================================
;   sub INFO_STATUS_JUEL
;=================================================
;   表示:STATUS(珠)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_JUEL(ARG)
#DIM L_HIT
#DIM L_CNT
#DIM L_COLOR

L_HIT=0
L_CNT=0
VARSET LOCAL
L_COLOR = GETCOLOR()

FOR LOCAL,0,VARSIZE("ABL")

	LOCALS = %PALAMNAME:LOCAL%
	SIF STRLENS(LOCALS) <= 0
		CONTINUE
	LOCAL:1 = JUEL:ARG:LOCAL

	SIF LOCAL:1 <= 0 && FLAG:STATUS伏字モード
		SETCOLOR COLOR("伏字")
	LOCALS += "の珠"
	PRINTFORM %LOCALS , 14%:
	PRINTFORM {LOCAL:1 , 5}
	SIF LOCAL:1 <= 0 && FLAG:STATUS伏字モード
		SETCOLOR L_COLOR
	PRINT  
	L_HIT = 1

	L_CNT += 1
	IF L_CNT > 3
		PRINTL
		L_CNT = 0
		L_HIT = 0
	ENDIF
NEXT

SIF L_HIT
	PRINTL

;=================================================
;   sub INFO_STATUS_GOTJUEL
;=================================================
;   表示:STATUS(取得珠)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_GOTJUEL(ARG)
#DIM L_HIT
#DIM L_CNT
#DIM L_COLOR

L_HIT=0
L_CNT=0
VARSET LOCAL
L_COLOR = GETCOLOR()

FOR LOCAL,0,VARSIZE("ABL")

	LOCALS = %PALAMNAME:LOCAL%
	SIF STRLENS(LOCALS) <= 0
		CONTINUE
	LOCAL:1 = GOTJUEL:ARG:LOCAL
	LOCAL:2 = JUEL:ARG:LOCAL

	SIF LOCAL:1 <= 0
		CONTINUE
	LOCALS += "の珠"
	PRINTFORM %LOCALS , 10%:
	PRINTFORM {LOCAL:2 , 5}(+{LOCAL:1 , 5})
	PRINT  
	L_HIT = 1

	L_CNT += 1
	IF L_CNT > 3
		PRINTL
		L_CNT = 0
		L_HIT = 0
	ENDIF
NEXT
SIF L_HIT
	PRINTL
PRINTL

;=================================================
;   sub INFO_STATUS_INTRODUCTION
;=================================================
;   表示:STATUS(紹介)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;  ARG:1				CSV優先
;-------------------------------------------------
@INFO_STATUS_INTRODUCTION(ARG, ARG:1=0)
#DIM L_TMP

IF ARG:1
	L_TMP = ARG
ELSE
	L_TMP = NO:ARG
ENDIF

REPEAT 4
	PRINTSL CSVCSTR(L_TMP, GETNUM(CSTR, "キャラ紹介" + TOSTR(COUNT)), 0)
REND

;=================================================
;   sub INFO_STATUS_OTHER
;=================================================
;   表示:STATUS(その他)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_STATUS_OTHER(ARG)
#DIM L_CNT
#DIM L_TMP
#DIMS L_STR
#DIM L_I

L_I = ARG

;- 主人の場合
IF ARG == MASTER
	PRINTFORML 陥落人数:{FLAG:陥落人数}人
	PRINTFORML 
	PRINTFORML 
ELSE
	;-----------------------------
	;- NTR
	;-----------------------------
	L_CNT=0
	L_TMP=CFLAG:ARG:ＮＴＲ再陥落回数
	IF L_TMP
		PRINTFORML ＮＴＲ再陥落回数：{L_TMP,2}回
		L_CNT ++
	ENDIF
	L_TMP=CFLAG:ARG:ＮＴＲ好感度
	IF L_TMP
		PRINTFORML ＮＴＲ好感度(%CSTR:ARG:ＮＴＲキャラ名%)：{L_TMP,3}/999
		L_CNT ++
	ENDIF
	WHILE 1
		SIF L_CNT >= 2
			BREAK
		PRINTL
		L_CNT ++
	WEND

ENDIF
TRYCALL 初体験記録(ARG)


PRINTFORML ――――――――――――――――――――――――%CALLNAME:L_I%の特殊素質――――――――――――――――――――――――
SIF TALENT:L_I:生還者 == 1
	PRINTFORML 機密Lv1 :【生還者】		「外敵」の脅威に晒されながら、都市の外側から生きて帰ってきた者。
SIF TALENT:L_I:実験体 == 1
	PRINTFORML 機密Lv2 :【実験体】		何かしらの実験をされていた者、要観察対象でもある。
SIF TALENT:L_I:青き血族 == 1
	PRINTFORML 機密Lv1 :【青き血族】		領主・王族などの血を引いた高貴な生まれ、現代では非常に珍しい。
SIF TALENT:L_I:マレビト == 1
	PRINTFORML 機密Lv1 :【マレビト】		ここではない所から来た者、運がない人たち。
SIF TALENT:L_I:旧世代人 == 1
	PRINTFORML 機密Lv2 :【旧世代人】		「外敵」に滅ぼされる前に生きていた者、旧文明の事にとても博識。
SIF TALENT:L_I:元性奴隷 == 1
	PRINTFORML 機密Lv1 :【元性奴隷】		以前は性奴隷だった者、せめてこちらでは大事にしよう。
SIF TALENT:L_I:人権損壊 == 1
	PRINTFORML 機密Lv2 :【人権損壊】		人権が著しく損なわれている者、あなたの保護がなければ家畜以下の待遇。
SIF TALENT:L_I:突然変異 == 1
	PRINTFORML 機密Lv3 :【突然変異】		有益な変異を遂げた個体、別に人外になっているわけではない。
SIF TALENT:L_I:先祖返り == 1
	PRINTFORML 機密Lv3 :【先祖返り】		かつての世代の特異性を発現した者、容姿もやや似ている。
SIF TALENT:L_I:記憶処理済 == 1
	PRINTFORML 機密Lv2 :【記憶処理済】		なにもおもいだせない
SIF TALENT:L_I:名家 == 1
	PRINTFORML 機密Lv0 :【名家】		何代も「プレイヤー」に仕えている一族、住人達の憧れの対象でもある。
SIF TALENT:L_I:極上の牝 == 1
	PRINTFORML 機密Lv1 :【極上の牝】		男性からは性的に同性からは嫉妬の視線を浴びるに足る容姿をしている。
SIF TALENT:L_I:マドンナ == 1
	PRINTFORML 機密Lv1 :【マドンナ】		男に想いを寄せられたこと数知れず、その身と心を狙われている。
SIF TALENT:L_I:白百合姫 == 1
	PRINTFORML 機密Lv1 :【白百合姫】		同性を愛し慈しみ、異性には殆ど関心がない。
SIF TALENT:L_I:AI専属被験者 == 1
	PRINTFORML 機密Lv2 :【AI専属被験者】		ＡＩ博士ノ「オ得意様」ナノ！、優先シテ実験シテアゲルノ！。
SIF TALENT:L_I:万年乳期 == 1
	PRINTFORML 機密Lv2 :【万年乳期】		妊娠の有無に関係なく母乳が出る特異体質、よく採れ甘くそして濃厚。
SIF TALENT:L_I:強化住人 == 1
	PRINTFORML 機密Lv6 :【強化住人】		ﾅﾆｶｼﾀﾅﾉｰ!!!
SIF TALENT:L_I:聖女の子宮 == 1
	PRINTFORML 機密Lv4 :【聖女の子宮】		どのような精子も受け入れ、優秀な子を育てる子宮を持つ。
SIF TALENT:L_I:聖女の血族 == 1
	PRINTFORML 重要機密:【聖女の血族】		最初期の都市を支えた偉大な大聖女、その血を色濃く継いだ者。教会で信仰対象にされる程の尊き血。
SIF TALENT:L_I:「シスター」 == 1
	PRINTFORML 機密Lv5 :【「シスター」】		あなたの妹という設定を書き込まれた個体。
SIF TALENT:L_I:「イェーガー」 == 1
	PRINTFORML 機密Lv5 :【「イェーガー」】		数多くの「外敵」を滅した者に「シティ」から送られる称号。
SIF TALENT:L_I:「マザー」 == 1
	PRINTFORML 機密Lv5 :【「マザー」】		多くの子を産み都市に貢献した者に「シティ」から送られる称号。
SIF TALENT:L_I:「ミューチュアル」 == 1
	PRINTFORML 重要機密:【「ミューチュアル」】	「外敵」の宿主でかつ共生している、何故共生出来ているのか解明は未だ出来ていない。
SIF CFLAG:L_I:住人_種族 == 13
	PRINTFORML 重要機密:【ニア】		「外敵」解明の一環として人工的に生み出された「外敵」の血を引く種族。
PRINTFORML ―――――――――――――――――――――――――――――――――――――――――――――――――――――――――

;=================================================
;   sub INFO_INTRODUCTION
;=================================================
;   表示:STATUS画面(詳細情報)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_PERSONAL(ARG)
#DIM L_I
#DIM L_TMP
#DIMS L_KEY
#DIM I_LOOP

I_LOOP = 1
L_TMP = NO:ARG
L_I = ARG:0


DRAWLINE
PRINTFORML ■------------------------------------ 詳細情報 ------------------------------------■

PRINTFORML ◇----------------住人情報----------------◇
CALL PRINT_STATUS(L_I, "所持金")
CALL PRINT_STATUS(L_I, "収入", , , ,1000000)
CALL PRINT_STATUS(L_I, "出費", , , ,1000000)
SIF Talent:L_I:アイドル != 0
	CALL PRINT_LABEL("ファン数",,(!CFLAG:L_I:ファンの数 && FLAG:STATUS伏字モード ? COLOR("伏字") # -1),TOSTR(CFLAG:L_I:ファンの数))
PRINTL 
CALL PRINT_STATUS(L_I, "人気"  , , , , 10000)
CALL PRINT_STATUS(L_I, "モラル", , , (L_I==MASTER ? "伏字"#""), 500 , , -500)
CALL PRINT_STATUS(L_I, "カルマ", , , (L_I==MASTER ? "伏字"#""), 500 , , -500)
CALL PRINT_STATUS(L_I, "品性"  , , , (L_I==MASTER ? "伏字"#""), 500 , , -500)
PRINTL
CALL PRINT_STATUS(L_I, "肉体ダメージ")
CALL PRINT_STATUS(L_I, "精神ダメージ")
PRINTL

IF TALENT:L_I:オトコ == 1 || TALENT:L_I:ふたなり
PRINTFORM 【ペニスサイズ:
	IF CFLAG:L_I:ペニスサイズ == 3
			PRINTFORM 巨根
	ELSEIF CFLAG:L_I:ペニスサイズ == 2
			PRINTFORM 短小包茎
	ELSEIF CFLAG:L_I:ペニスサイズ == 1
			PRINTFORM 包茎
	ELSE
			PRINTFORM 標準
	ENDIF
PRINTFORML 】
ENDIF

PRINTFORML ◇----------------精神情報----------------◇
CALL PRINT_STATUS(L_I, "忠誠値")
CALL PRINT_STATUS(L_I, "愛情値")
CALL PRINT_STATUS(L_I, "淫乱値")
PRINTL


PRINTFORML ■------------------------------------ 悩み一覧 ------------------------------------■
PRINTFORML ◇----------------大きな悩み----------------◇
REPEAT 5
	IF CFlag:L_I:(4000+I_LOOP) != 0
		IF CFlag:L_I:(4100+I_LOOP) >= 100
			IF CFlag:L_I:(4000+I_LOOP) <= 199
				SETCOLOR COLOR("悩み_金銭")
				CALL PRINT_LABEL("金銭問題")
			ELSEIF CFlag:L_I:(4000+I_LOOP) <= 299
				SETCOLOR COLOR("悩み_恋愛")
				CALL PRINT_LABEL("恋愛問題")
			ELSEIF CFlag:L_I:(4000+I_LOOP) <= 399
				SETCOLOR COLOR("悩み_家庭")
				CALL PRINT_LABEL("家庭問題")
			ELSEIF CFlag:L_I:(4000+I_LOOP) <= 499
				SETCOLOR COLOR("悩み_生活")
				CALL PRINT_LABEL("生活問題")
			ELSEIF CFlag:L_I:(4000+I_LOOP) <= 599
				SETCOLOR COLOR("悩み_犯罪")
				CALL PRINT_LABEL("犯罪問題")
			ELSEIF CFlag:L_I:(4000+I_LOOP) <= 699
				SETCOLOR COLOR("悩み_性的")
				CALL PRINT_LABEL("性的問題")
			ENDIF
		ELSE
			SIF FLAG:STATUS伏字モード
				SETCOLOR COLOR("伏字")
			PRINTFORM ？？？(未判明)
			CALL PRINT_LABEL("解析",,,TOSTR(CFlag:L_I:(4100+I_LOOP)),3,,"/","100")
		ENDIF
		PRINTFORM 難度:{CFlag:L_I:(4300+I_LOOP),2}　
		PRINTFORML 達成率:({CFlag:L_I:(4200+I_LOOP),3}/100)
		RESETCOLOR
	ENDIF
	I_LOOP += 1
REND
PRINTFORML ◇----------------小さな悩み----------------◇
I_LOOP = 1
REPEAT 5
	IF CFlag:L_I:(4010+I_LOOP) != 0
		IF CFlag:L_I:(4110+I_LOOP) >= 100
			IF CFlag:L_I:(4010+I_LOOP) <= 199
				SETCOLOR COLOR("悩み_金銭")
				CALL PRINT_LABEL("金銭問題")
			ELSEIF CFlag:L_I:(4010+I_LOOP) <= 299
				SETCOLOR COLOR("悩み_恋愛")
				CALL PRINT_LABEL("恋愛問題")
			ELSEIF CFlag:L_I:(4010+I_LOOP) <= 399
				SETCOLOR COLOR("悩み_家庭")
				CALL PRINT_LABEL("家庭問題")
			ELSEIF CFlag:L_I:(4010+I_LOOP) <= 499
				SETCOLOR COLOR("悩み_生活")
				CALL PRINT_LABEL("生活問題")
			ELSEIF CFlag:L_I:(4010+I_LOOP) <= 599
				SETCOLOR COLOR("悩み_犯罪")
				CALL PRINT_LABEL("犯罪問題")
			ELSEIF CFlag:L_I:(4010+I_LOOP) <= 699
				SETCOLOR COLOR("悩み_性的")
				CALL PRINT_LABEL("性的問題")
			ENDIF
		ELSE
			SIF FLAG:STATUS伏字モード
				SETCOLOR COLOR("伏字")
			PRINTFORM ？？？(未判明)
			CALL PRINT_LABEL("解析",,,TOSTR(CFlag:L_I:(4100+I_LOOP)),3,,"/","100")
		ENDIF
		PRINTFORM 難度:{CFlag:L_I:(4310+I_LOOP),2}　
		PRINTFORML 達成率:({CFlag:L_I:(4210+I_LOOP),3}/100)
		RESETCOLOR
	ENDIF
	I_LOOP += 1
REND
PRINTFORML ■------------------------------------ 身体情報 ------------------------------------■
SIF TALENT:L_I:オトコ == 0 || MASTER != L_I
	CALL C_PICTURE_S(ARG:0)

SIF !LINEISEMPTY()
	PRINTL


;=================================================
;   表示:STATUS画面(隠し性情報)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_SEX(ARG)
#DIM L_I
#DIM P_S
#DIMS LSTR
L_I = ARG
P_S = 0
IF MASTER == L_I
PRINTFORML 
CALL PRINT_STATUS(L_I, "男体レベル")
SIF !CFlag:L_I:男体経験値 && !CFlag:L_I:男体レベル && Flag:STATUS伏字モード
	SETCOLOR COLOR("伏字")
PRINTFORML ({CFlag:L_I:男体経験値}/{CFlag:L_I:男体レベル*2})
RESETCOLOR
CALL PRINT_STATUS(L_I, "精子レベル")
SIF !CFlag:L_I:精子経験値 && !CFlag:L_I:精子レベル && Flag:STATUS伏字モード
	SETCOLOR COLOR("伏字")
PRINTFORML ({CFlag:L_I:精子経験値}/{((CFlag:L_I:精子レベル)*5)+CFlag:L_I:精子レベル})
RESETCOLOR
PRINTFORML 
ELSEIF TALENT:L_I:オトコ == 0 || MASTER != L_I
	CALL C_PICTURE_S_S(ARG)
	PRINTFORML ■----------------%CALLNAME:L_I%が持つ無自覚の素質----------------■
	IF TALENT:L_I:オトコ == 0
		IF CFlag:L_I:無自覚な雌 >= 80
			IF !RAND:5
				PRINTFORML 「……%UNICODE(0x2661)%」
			ELSEIF !RAND:4
				PRINTFORML 「%CSTR:L_I:二人称%の子供は、とても優秀な子になりそう%CSTR:L_I:語尾同意求む%」
			ELSEIF !RAND:3
				PRINTFORML 「子供とか興味あ%CSTR:L_I:語尾対応%、%CSTR:L_I:二人称%は？」
			ELSEIF !RAND:2
				PRINTFORML (%CSTR:L_I:一人称%…いつの間にか身体摺り寄せて……)
			ELSE
				PRINTFORML 「隣でも大丈夫%CSTR:L_I:語尾問う%？、この方が聞きやすくていい%CSTR:L_I:語尾繋ぎ%%CSTR:L_I:語尾です%」
			ENDIF
		ELSEIF CFlag:L_I:無自覚な雌 >= 60
			IF !RAND:5
				PRINTFORML 「今日も話たくさん聞いてもらっていい%CSTR:L_I:語尾問う%？」
			ELSEIF !RAND:4
				PRINTFORML 「%CSTR:L_I:二人称%は女性に興味あ%CSTR:L_I:語尾聞く%？」
			ELSEIF !RAND:3
				PRINTFORML 「……♪」
			ELSEIF !RAND:2
				PRINTFORML 「%CSTR:L_I:語尾何？%%UNICODE(0x2661)%」
			ELSE
				PRINTFORML 「身体熱い…%CSTR:L_I:語尾逆説%…心地いい%CSTR:L_I:語尾応答2%…」
			ENDIF
		ELSEIF CFlag:L_I:無自覚な雌 >= 40
			IF !RAND:5
				PRINTFORML 「%CSTR:L_I:二人称%の話はいつも面白い%CSTR:L_I:語尾応答2%」
			ELSEIF !RAND:4
				PRINTFORML 「…っん」
			ELSEIF !RAND:3
				PRINTFORML 「…いつも%CSTR:L_I:語尾感謝%」
			ELSEIF !RAND:2
				PRINTFORML 「身体が火照って…」
			ELSE
				PRINTFORML 「%CSTR:L_I:二人称%になら触られても平気%CSTR:L_I:語尾許可%」
			ENDIF
		ELSEIF CFlag:L_I:無自覚な雌 >= 20
			IF !RAND:5
				PRINTFORML 「%CSTR:L_I:二人称%に話を聞いてもらって助かって%CSTR:L_I:語尾ます%」
			ELSEIF !RAND:4
				PRINTFORML 「もっと話を聞いてもらっていい%CSTR:L_I:語尾問う%？」
			ELSEIF !RAND:3
				PRINTFORML 「%CSTR:L_I:二人称%ってよく見るといい感じだと思う%CSTR:L_I:語尾繋ぎ%%CSTR:L_I:語尾です%」
			ELSEIF !RAND:2
				PRINTFORML 「少し近づいていい%CSTR:L_I:語尾問う%？」
			ELSE
				PRINTFORML 「少し熱い%CSTR:L_I:語尾応答2%、なんで%CSTR:L_I:語尾疑問%…？」
			ENDIF
		ELSE 
			IF !RAND:5
				PRINTFORML 「%CSTR:L_I:一人称%の顔に何かついてるの%CSTR:L_I:語尾問う%？」
			ELSEIF !RAND:4
				PRINTFORML 「……？」
			ELSEIF !RAND:3
				PRINTFORML 「………どうか%CSTR:L_I:語尾問う4%？」
			ELSEIF !RAND:2
				PRINTFORML 「特に問題はない%CSTR:L_I:語尾許可%」
			ELSE
				PRINTFORML 「…？、%CSTR:L_I:語尾何？%」
			ENDIF
		ENDIF







		IF CFlag:L_I:フェロモン >= 1
		PRINTFORM ・【フェロモン】男性
			IF CFlag:L_I:フェロモン >= 90
				PRINTFORM への影響力が甚大で、あなたの保護なしではまともに生活できない程の凄まじいフェロモンを放っています
				CALL CP_HEARTB_PINK, 10
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 80
				PRINTFORM 達の理性を圧倒し、組み伏せて孕ませようとさせる程のフェロモンを放っています
				CALL CP_HEARTB_PINK(9)
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 70
				PRINTFORM 達が彼女の色香により勃起を抑えられなくなる程のフェロモンを放っています
				CALL CP_HEARTB_PINK(8)
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 60
				PRINTFORM 達が一目見て子を孕ませたくなる程のフェロモンを放っています
				CALL CP_HEARTB_PINK(7)
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 50
				PRINTFORM 達がどうにかして関係を結べないかと魅了されるフェロモンを放っています
				CALL CP_HEARTB_PINK(6)
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 40
				PRINTFORM 達から性的な視線を向けられるのを避けられない程のフェロモンを放っています。
				CALL CP_HEARTB_PINK(5)
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 30
				PRINTFORM からとても好かれる程度のフェロモンを放っています
				CALL CP_HEARTB_PINK(4)
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 20
				PRINTFORM に魅力的な女性だと思われるフェロモンを放っています
				CALL CP_HEARTB_PINK(3)
				PRINTL
			ELSEIF CFlag:L_I:フェロモン >= 10
				PRINTFORM を若干性的興奮にさせるフェロモンを放っています
				CALL CP_HEARTB_PINK(2)
				PRINTL
			ELSE
				PRINTFORM から関心を寄せられる程度のフェロモンを放っています
				CALL CP_HEARTB_PINK()
				PRINTL
			ENDIF
		ENDIF

		PRINTFORM ・【雌の本能　】
		IF CFlag:L_I:雌の本能 >= 90
			PRINTFORM 常に妊娠していないと情緒不安定になる程の異常な生殖本能です
			CALL CP_HEARTB_PINK(10)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 80
			PRINTFORM 優秀な雄がいると無意識に誘惑して生殖行為に至ろうとする程の生殖本能を持っています
			CALL CP_HEARTB_PINK(9)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 70
			PRINTFORM 避妊すると逆に不機嫌になる程の生殖本能があります
			CALL CP_HEARTB_PINK(8)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 60
			PRINTFORM 優秀な雄がいると子を孕みたくなる程の生殖本能を持っています
			CALL CP_HEARTB_PINK(7)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 50
			PRINTFORM 生殖本能と呼ぶにはやや異常な欲求度です
			CALL CP_HEARTB_PINK(6)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 40
			PRINTFORM 雄が近くにいると子宮が疼く程の生殖本能を持っています
			CALL CP_HEARTB_PINK(5)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 30
			PRINTFORM 生殖に対してかなり前向きな意思があります
			CALL CP_HEARTB_PINK(4)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 20
			PRINTFORM 雌としては若干強い生殖本能を持っています
			CALL CP_HEARTB_PINK(3)
			PRINTL
		ELSEIF CFlag:L_I:雌の本能 >= 10
			PRINTFORM 雌として良好な生殖本能を持っています
			CALL CP_HEARTB_PINK(2)
			PRINTL
		ELSE
			PRINTFORM 雌として一般的な生殖本能を持っています
			CALL CP_HEARTB_PINK()
			PRINTL
		ENDIF

		PRINTFORM ・【性への興味】
		IF CFlag:L_I:性への興味 >= 90
			PRINTFORM 性体験を追求することは人として当たり前だと主張しています
			CALL CP_HEARTB_PINK(10)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 80
			PRINTFORM 性に関しては知り尽くしており、実体験を深めていきたいと思うほどです
			CALL CP_HEARTB_PINK(9)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 70
			PRINTFORM かなり性への興味があり、いつも性的妄想をしているほどです
			CALL CP_HEARTB_PINK(8)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 60
			PRINTFORM 強い性への興味があり、夜な夜な想像しては興奮しています
			CALL CP_HEARTB_PINK(7)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 50
			PRINTFORM 少しでも性的描写があると、つい拡大妄想してしまいます
			CALL CP_HEARTB_PINK(6)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 40
			PRINTFORM 性への探求の一環として幾つかの性的道具を所有しています
			CALL CP_HEARTB_PINK(5)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 30
			PRINTFORM 性的なジャンルに一切の抵抗を持ちません
			CALL CP_HEARTB_PINK(4)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 20
			PRINTFORM 人目がなければ性に関する情報も仕入れています
			CALL CP_HEARTB_PINK(3)
			PRINTL
		ELSEIF CFlag:L_I:性への興味 >= 10
			PRINTFORM それなりに性への興味があり、関係するものを多少調べています
			CALL CP_HEARTB_PINK(2)
			PRINTL
		ELSE
			PRINTFORM 性への関心は一般的です
			CALL CP_HEARTB_PINK()
			PRINTL
		ENDIF

		PRINTFORM ・【雄への関心】
		IF CFlag:L_I:雄への関心 >= 90
			PRINTFORM 意中の相手に侍り、蕩けたように媚を売る雌の中の雌です
			CALL CP_HEARTB_PINK(10)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 80
			PRINTFORM タイプの男性にはすり寄って雌アピールする程に雄への関心があります
			CALL CP_HEARTB_PINK(9)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 70
			PRINTFORM 異性に甘く、同性には厳しい態度を取る程の雄への関心があります
			CALL CP_HEARTB_PINK(8)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 60
			PRINTFORM 生殖器を見ると性的興奮する程に雄への関心があります
			CALL CP_HEARTB_PINK(7)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 50
			PRINTFORM 男性の裸を見てみたいと思う程に雄への関心があります
			CALL CP_HEARTB_PINK(6)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 40
			PRINTFORM タイプの男性の生殖器はどのようなのか知りたくなるほどに雄への関心があります
			CALL CP_HEARTB_PINK(5)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 30
			PRINTFORM 異性への偏見をまったく持っていません
			CALL CP_HEARTB_PINK(4)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 20
			PRINTFORM 自然とタイプの男性を探す程度には雄への関心があります
			CALL CP_HEARTB_PINK(3)
			PRINTL
		ELSEIF CFlag:L_I:雄への関心 >= 10
			PRINTFORM 抵抗もなく男性と対話できる程度の雄への関心があります
			CALL CP_HEARTB_PINK(2)
			PRINTL
		ELSE
			PRINTFORM 男性への関心はそれほど強くありません
			CALL CP_HEARTB_PINK()
			PRINTL
		ENDIF

		PRINTFORM ・【性交願望　】
		IF CFlag:L_I:性交願望 >= 90
			PRINTFORM サキュバスと見紛う程の性行為への欲求を持っています
			CALL CP_HEARTB_PINK(10)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 80
			PRINTFORM 出来るならずっと交尾したいほどに性行為を望んでいるようです
			CALL CP_HEARTB_PINK(9)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 70
			PRINTFORM 何度絶頂しても尽きない性行為への欲求があります
			CALL CP_HEARTB_PINK(8)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 60
			PRINTFORM 獣のような性行為を望んでいるようです
			CALL CP_HEARTB_PINK(7)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 50
			PRINTFORM 膣内をかき回すような性行為を望んでいるようです
			CALL CP_HEARTB_PINK(6)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 40
			PRINTFORM 激しい性行為がしたい程に性行為を望んでいるようです
			CALL CP_HEARTB_PINK(5)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 30
			PRINTFORM 女性が持つには強い性交願望を持っているようです
			CALL CP_HEARTB_PINK(4)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 20
			PRINTFORM 互いに満足できる性行為をしたいようです
			CALL CP_HEARTB_PINK(3)
			PRINTL
		ELSEIF CFlag:L_I:性交願望 >= 10
			PRINTFORM 気持ちよくなれるなら応じる程度の性交願望があります
			CALL CP_HEARTB_PINK(2)
			PRINTL
		ELSE
			PRINTFORM 性行為については好きでもないようです
			CALL CP_HEARTB_PINK()
			PRINTL
		ENDIF

		PRINTFORM ・【妊娠願望　】
		IF CFlag:L_I:妊娠願望 >= 90
			PRINTFORM 子宮と脳が直結しているのかと思うほどの妊娠願望があります
			CALL CP_HEARTB_PINK(10)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 80
			PRINTFORM 好きな人との交尾ならすぐさま排卵が始める程に妊娠したいようです
			CALL CP_HEARTB_PINK(9)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 70
			PRINTFORM 好きな人との子なら何人でも産みたいと思っているようです
			CALL CP_HEARTB_PINK(8)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 60
			PRINTFORM 子宮が孕みたいと疼き続ける程に妊娠したいようです
			CALL CP_HEARTB_PINK(7)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 50
			PRINTFORM 子宝には恵まれたいと妊娠には前向きな姿勢です
			CALL CP_HEARTB_PINK(6)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 40
			PRINTFORM 性行為したからには孕みたいと思うほど妊娠したいようです
			CALL CP_HEARTB_PINK(5)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 30
			PRINTFORM 中出しによる妊娠への不安はないようです
			CALL CP_HEARTB_PINK(4)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 20
			PRINTFORM 好きな人の子は産みたいと思っているようです
			CALL CP_HEARTB_PINK(3)
			PRINTL
		ELSEIF CFlag:L_I:妊娠願望 >= 10
			PRINTFORM 段階を踏んでいるのなら妊娠を容認するようです
			CALL CP_HEARTB_PINK(2)
			PRINTL
		ELSE
			PRINTFORM あまり妊娠はしたくないと思っているようです
			CALL CP_HEARTB_PINK()
			PRINTL
		ENDIF
	ENDIF
ENDIF
DRAWLINE



PRINTFORML
PRINTFORML

;=================================================
;   表示:STATUS画面(RPG情報)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_RPG(L_I)
#DIM L_I
PRINTFORML ■------------------------------------ 戦闘詳細 ------------------------------------■
PRINTFORML ◇----------------身体情報----------------◇
CALL PRINT_RANGE_STATUS(L_I, "HP", "体力", , 3, "伏字", "％")
CALL PRINT_RANGE_STATUS(L_I, "SP", "気力", , 3, "伏字", "％")
PRINTL
CALL PRINT_STATUS(L_I, "GUTS" , , 3)
CALL PRINT_STATUS(L_I, "BRAVE", , 3)
CALL PRINT_STATUS(L_I, "SAN"  , , 3)
PRINTL
CALL PRINT_STATUS(L_I, "経験値")
PRINTL
CALL PRINT_STATUS(L_I, "ATK"  , , 3)
CALL PRINT_STATUS(L_I, "DEF"  , , 3)
PRINTL
CALL PRINT_STATUS(L_I, "HIT"  , , 3)
CALL PRINT_STATUS(L_I, "SPD"  , , 3)
CALL PRINT_STATUS(L_I, "LUK"  , , 3)
PRINTL
CALL PRINT_RANGE_STATUS(L_I, "BRE", , , 3, "伏字", "％")
PRINTL
CALL INFO_RPG_SKILL(L_I)
CALL INFO_RPG_WEAPON(L_I)
PRINTFORML 


@INFO_RPG_SKILL(L_I)
#DIM L_I
#DIM CONST SKILL_LABEL_SPAN = 8
PRINTFORML ◇----------------技能情報----------------◇
CALL PRINT_STATUS(L_I, "目星"    , SKILL_LABEL_SPAN, 3)
CALL PRINT_STATUS(L_I, "アイデア", SKILL_LABEL_SPAN, 3)
CALL PRINT_STATUS(L_I, "聞き耳"  , SKILL_LABEL_SPAN, 3)
CALL PRINT_STATUS(L_I, "医療"    , SKILL_LABEL_SPAN, 3)
PRINTL
CALL PRINT_STATUS(L_I, "機械修理", SKILL_LABEL_SPAN, 3)
CALL PRINT_STATUS(L_I, "コンピュータ", SKILL_LABEL_SPAN, 3)
CALL PRINT_STATUS(L_I, "鍵開け", SKILL_LABEL_SPAN, 3)
CALL PRINT_STATUS(L_I, "隠れる", SKILL_LABEL_SPAN, 3)
PRINTL
CALL PRINT_STATUS(L_I, "解体", SKILL_LABEL_SPAN, 3)
CALL PRINT_STATUS(L_I, "解読", SKILL_LABEL_SPAN, 3)
PRINTL
@INFO_RPG_WEAPON(L_I)
#DIM L_I
#DIM CONST _INFO_RPG_WEPON_SPAN = 23
PRINTFORML ◇----------------武装情報----------------◇
PRINTFORML □-----メイン兵装-----□□----- サブ兵装 -----□
SIF L_I == MASTER && FLAG:STATUS伏字モード
	SETCOLOR COLOR("伏字")
CALL PRINT_LABEL(CSTR:L_I:4000, -19)
PRINTFORM %" " * MAX(0, _INFO_RPG_WEPON_SPAN-RESULT)%
CALL PRINT_LABEL(CSTR:L_I:4010, -19)
PRINTL
CALL PRINT_LABEL("タイプ",,,INFO_STR_HEISOU(CFlag:L_I:住人_M兵装), -4)
PRINTFORM %" " * MAX(0, _INFO_RPG_WEPON_SPAN-RESULT)%
CALL PRINT_LABEL("タイプ",,,INFO_STR_HEISOU(CFlag:L_I:住人_S兵装), -4)
PRINTL
CALL PRINT_LABEL("練度",,,@"\@ CFlag:L_I:住人_M兵装練度?{CFlag:L_I:住人_M兵装練度}#\@", -3 )
PRINTFORM %" " * MAX(0, _INFO_RPG_WEPON_SPAN-RESULT)%
CALL PRINT_LABEL("練度",,,@"\@ CFlag:L_I:住人_S兵装練度?{CFlag:L_I:住人_S兵装練度}#\@", -3 )
PRINTL
CALL PRINT_LABEL("ダメージ",,,INFO_STR_MAIN_WEAPON_DAMAGE(L_I))
PRINTFORM %" " * MAX(0, _INFO_RPG_WEPON_SPAN-RESULT)%
CALL PRINT_LABEL("ダメージ",,,INFO_STR_SUB_WEAPON_DAMAGE(L_I))
PRINTL
RESETCOLOR




;=================================================
;   sub INFO_INTRODUCTION
;=================================================
;   表示:STATUS画面(紹介)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_INTRODUCTION(ARG)
#DIM L_I
#DIM L_LOOP

L_I = ARG
L_LOOP = 0
DRAWLINE
PRINTFORML ■------------------------------------初期プロフィール ------------------------------------■
DRAWLINE
REPEAT 20
	SIF L_LOOP >= 2
		SETCOLOR 50,250,150
	SIF L_LOOP >= 5
		SETCOLOR 250,250,50
	SIF L_LOOP >= 9
		SETCOLOR 250,50,50
	SIF L_LOOP >= 13
		SETCOLOR 250,0,0
	SIF CSTR:L_I:(70+L_LOOP) != ""
		PRINTFORML %CSTR:L_I:(70+L_LOOP)%
	L_LOOP += 1
REND
IF L_I == MASTER
	SETCOLOR 250,50,50
	PRINTFORML 【機密Lv8:所属】あなたは都市を発展・繁栄させる「プレイヤー」の一人です。
	PRINTFORML 【機密Lv9:運営】上記の任についている間、都市の住人を権限が許す限り利用できます。
	SETCOLOR 250,0,0
	PRINTFORML 【重要機密:権限】あなたに許可されている権限は――――――――――－－－－□○種です。
	PRINTFORML 【重要機密:一族】４０４　Ｅｒｒｏｒ
	PRINTFORML 【重要機密:　　】４０３　Ｅｒｒｏｒ
	PRINTFORML 【重要機密:　　】４０３　Ｅｒｒｏｒ
	PRINTFORML 【重要機密:　　】４０３　Ｅｒｒｏｒ
	PRINTFORML 【重要機密:人権】あなたには第一級人権が付与されています、　　　　　　　　　　人権に守られています。
	PRINTFORML 【重要機密:　　】４０３　Ｅｒｒｏｒ
	PRINTFORML 【　　機密:　　】あなたには一切の許可がされていません。
	PRINTFORML 【　　機密:　　】あなたは　　　　　への　　に必ず　　なければなりません。
ENDIF
RESETCOLOR
DRAWLINE





;=================================================
;   sub INFO_SIMPLE_STATUS_EXP
;=================================================
;   簡易表示:STATUS(経験)
;-------------------------------------------------
; Input:
;  ARG:0				対象キャラ
;-------------------------------------------------
@INFO_SIMPLE_STATUS_EXP(ARG)
#DIM L_HIT
#DIM L_CNT

L_HIT=0
L_CNT=0
VARSET LOCAL

FOR LOCAL,0,VARSIZE("EXP")

	LOCALS = %EXPNAME:LOCAL%
	SIF STRLENS(LOCALS) <= 0
		CONTINUE
	LOCAL:1 = EXP:ARG:LOCAL
	SIF !LOCAL:1
		CONTINUE

	PRINTFORM %LOCALS , 16%
	PRINTFORM :LV{GETEXPLV(LOCAL:1,9), 2, LEFT}
	PRINTFORM (%TOSTR(LOCAL:1) , 4%回)
	PRINT  
	L_HIT = 1

	L_CNT += 1
	IF L_CNT > 2
		PRINTL
		L_CNT = 0
		L_HIT = 0
	ENDIF

NEXT

SIF L_HIT
	PRINTL



;-------------------------------------------------
;ラベル使用キャラステータス参照関数
;-------------------------------------------------
;ラベル名から指定キャラのステータス値を参照する
;ラベル名が不正な場合は0
@INFO_STATUS_GET_BY_LABEL(C_ID, LABEL_NAME)
#FUNCTION
#LOCALSIZE 1
#LOCALSSIZE 1
#DIM  C_ID           ;
#DIMS LABEL_NAME     ;
#DIMS LABEL_VAR_NAME ;
#DIM  LABEL_VAR_ID   ;
IF CHARA_SORT_FIND_LABEL(LABEL_NAME, LABEL_VAR_NAME, LABEL_VAR_ID)
	RETURNF C_GET_CVAR_VALUE(C_ID, LABEL_VAR_NAME, LABEL_VAR_ID)
ELSE
	DEBUGPRINTFORML INFO_STATUS_GET_BY_LABEL, 不正なLABEL_NAME %LABEL_NAME%
	RETURNF 0
ENDIF


;-------------------------------------------------
;個人の悩み一覧関数
;-------------------------------------------------
;仕様書いてないからよくわかんねーけど
;とりあえず大小各1～9までが悩みスロットと解釈したよ？
@INFO_STATUS_NAYAMI_LIST(C_ID, OP)
#DIM  C_ID   ;登録番号
#DIMS OP     ;実行オプション
#DIM  I_LOOP ;ループ用
DRAWLINE
PRINTFORML ◇----------------大きな悩み----------------◇
IF STRCOUNT(OP, "「ボタン」")
	FOR I_LOOP, 1, 9
		SIF CFLAG:C_ID:(4000 + I_LOOP) <= 0
			CONTINUE
		IF CFLAG:C_ID:(4200 + I_LOOP) >= 100
			PRINTFORM 解決　
		ELSE
			PRINTFORM [{I_LOOP, 2}]
		ENDIF
		CALL INFO_STATUS_NAYAMI(C_ID, I_LOOP)
	NEXT
ELSE
	FOR I_LOOP, 1, 9
		SIF CFLAG:C_ID:(4000 + I_LOOP) <= 0
			CONTINUE
		CALL INFO_STATUS_NAYAMI(C_ID, I_LOOP)
	NEXT
ENDIF
PRINTFORML ◇----------------小さな悩み----------------◇
IF STRCOUNT(OP, "「ボタン」")
	FOR I_LOOP, 11, 19
		SIF CFLAG:C_ID:(4000 + I_LOOP) <= 0
			CONTINUE
		IF CFLAG:C_ID:(4200 + I_LOOP) >= 100
			PRINTFORM 解決　
		ELSE
			PRINTFORM [{I_LOOP, 2}]
		ENDIF
		CALL INFO_STATUS_NAYAMI(C_ID, I_LOOP)
	NEXT
ELSE
	FOR I_LOOP, 11, 19
		SIF CFLAG:C_ID:(4000 + I_LOOP) <= 0
			CONTINUE
		CALL INFO_STATUS_NAYAMI(C_ID, I_LOOP)
	NEXT
ENDIF

;-------------------------------------------------
;悩み情報表示関数
;-------------------------------------------------
@INFO_STATUS_NAYAMI(C_ID, NAYAMI_ID)
#DIM C_ID
#DIM NAYAMI_ID
IF CFLAG:C_ID:(4100 + NAYAMI_ID) >= 100
	SELECTCASE CFLAG:C_ID:(4000 + NAYAMI_ID)
	CASE IS <= 199
		SETCOLOR COLOR("悩み_金銭")
		CALL PRINT_LABEL("金銭問題")
	CASE IS <= 299
		SETCOLOR COLOR("悩み_恋愛")
		CALL PRINT_LABEL("恋愛問題")
	CASE IS <= 399
		SETCOLOR COLOR("悩み_家庭")
		CALL PRINT_LABEL("家庭問題")
	CASE IS <= 499
		SETCOLOR COLOR("悩み_生活")
		CALL PRINT_LABEL("生活問題")
	CASE IS <= 599
		SETCOLOR COLOR("悩み_犯罪")
		CALL PRINT_LABEL("犯罪問題")
	CASE IS <= 699
		SETCOLOR COLOR("悩み_性的")
		CALL PRINT_LABEL("性的問題")
	ENDSELECT
ELSE
	SIF FLAG:STATUS伏字モード
		SETCOLOR COLOR("伏字")
	PRINTFORM ？？？(未判明)
	CALL PRINT_LABEL("解析",,,TOSTR(CFLAG:C_ID:(4100 + NAYAMI_ID)),3,,"/","100")
ENDIF
PRINTFORM 　難度：{CFLAG:C_ID:(4300 + NAYAMI_ID),2}　
PRINTFORM 達成率：({CFLAG:C_ID:(4200 + NAYAMI_ID),3}/100)
RESETCOLOR
SIF NAYAMI_ID == CFLAG:C_ID:住人_悩み解決選択
	PRINTFORM 　現在解決中
PRINTFORML 
